import{u as S,A as k,y as r,E as D,G as N,B as T,q as R,o as _,a as C,d as v,h as B,f as W,n as U,H as j,I as q,i as G,r as H,c as $,w as O,e as K,F as X,b as J,t as E}from"./vue-libs-cc25d22f.js";import{_ as I}from"./locales-c5205a71.js";const c=navigator.userAgent,V=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"];let M=!1;for(let s=0;s<V.length;s++)if(c.indexOf(V[s])>-1){M=!0;break}c.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),c.indexOf("Android")>-1||c.indexOf("Linux")>-1,c.indexOf("iPhone")>-1,c.indexOf("iPad")>-1;const Q=(s,a)=>new Promise(t=>{const e=S(s,(...u)=>{a(...u)&&(e(),t(!0))})}),Y={class:"turntable-ls"},z=Symbol("getDeg"),Z={name:"Turntable"},ee=k({...Z,props:{during:{default:1500},rotateWhenReady:{type:Boolean,default:!1},offset:{default:0}},emits:["over"],setup(s,{expose:a,emit:t}){const e=s,u=r(),f=D(()=>e.during/1e3+"s"),i=r(!1);function y(){i.value=!1,t("over")}const g=n=>{const o=n.split("(")[1].split(")")[0].split(","),l=o[0],d=o[1];return Math.round(Math.atan2(parseFloat(d),parseFloat(l))*(180/Math.PI))},w=((n={el:()=>document.createElement("div")})=>{const o=r(!1),l=r(!1);T(()=>{l.value=!0});const d=D(()=>({"turntable-active":o.value,"turntable-ready":e.rotateWhenReady==!1?!1:l.value})),h=r("0deg"),A=r("0deg"),P=r(!1);return{init(){S([h,A,f],()=>{n.el().style.setProperty("--fromDeg",h.value),n.el().style.setProperty("--endDeg",A.value),n.el().style.setProperty("--duringVal",f.value)},{immediate:!0})},draw(F){P.value||(P.value=!0,h.value=g(window.getComputedStyle(n.el()).transform)%360+"deg",A.value=720-360/m.value*F-e.offset+"deg",l.value=!1,o.value=!0,setTimeout(()=>{P.value=!1,y(),o.value=!1,l.value=!0},e.during))},elClass:d}})({el(){return u.value||document.createElement("div")}}),m=r(0),L=r([]);S(m,n=>{Array.from({length:n}).forEach((o,l)=>{let d=360/n*l-e.offset+"deg";L.value[l]=d,p[l](d)})},{immediate:!0});const p=[];N(z,n=>{m.value++,p.push(n)}),T(()=>{w.init()});const x=r(!0);return a({draw(n){return i.value=!0,w.draw(n),Q(i,o=>o==!1)},updateSize(){x.value=!1,m.value=0,p.splice(0,p.length),R(()=>{x.value=!0})}}),(n,o)=>(_(),C("div",{ref_key:"turntableEl",ref:u,class:U(["turntable",j(w).elClass.value])},[v("div",Y,[x.value?B(n.$slots,"default",{key:0},void 0,!0):W("",!0)])],2))}});const te=I(ee,[["__scopeId","data-v-54d61889"]]),ae={name:"TurntableItem"},ne=k({...ae,setup(s){const a=q(z,()=>{}),t=r("0deg");return a(e=>{t.value=e}),(e,u)=>(_(),C("div",{class:"turntable-item",style:G({transform:"rotate("+t.value+")"})},[B(e.$slots,"default")],4))}}),se={class:"my-turntable"},re={class:"name"},oe=["src"],le=k({__name:"index",setup(s){const a=r(Array.from({length:8}).map((f,i)=>({name:"下标"+i,icon:"https://h5.carryu.com.cn/wcfe__test/mass2/assets/b1-354ce1e4.png"})));setTimeout(()=>{a.value=Array.from({length:5}).map((f,i)=>({name:"下标"+i,icon:"https://h5.carryu.com.cn/wcfe__test/mass2/assets/b1-354ce1e4.png"})),t.value&&t.value.updateSize()},5e3);const t=r(),e=r(0);function u(){t.value&&(e.value=~~(Math.random()*a.value.length),t.value.draw(e.value))}return(f,i)=>{const y=H("demo-block");return _(),$(y,{title:"基础用法"},{default:O(()=>[v("div",se,[K(te,{ref_key:"turntableVm",ref:t,during:3e3,"rotate-when-ready":!0},{default:O(()=>[(_(!0),C(X,null,J(a.value,(g,b)=>(_(),$(ne,{key:b,idx:b},{default:O(()=>[v("div",re,E(g.name),1),v("img",{src:g.icon,alt:"",class:"icon"},null,8,oe)]),_:2},1032,["idx"]))),128))]),_:1},512)]),v("div",{class:"start-btn",onClick:u}," 点击抽奖（结果下标："+E(e.value)+"） ",1)]),_:1})}}});const de=I(le,[["__scopeId","data-v-f614178f"]]);export{de as default};
